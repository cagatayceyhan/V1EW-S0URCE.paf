# Web For Pentester XSS Write Up

**Web for Pentester,  PentesterLab tarafından Web Pentesting uygulaması için hazırlanmış bir Sanal Makine ISO’dur.**

İçerisinde:

* XSS
* SQL Injection
* Directory Traversal
* File Include
* Code Injection
* Command Injection
* File Upload
* LDAP
  
Konu başlıkları altında güvenlik zafiyeti barındıran uygulamalar yer alır.

Bu yazımda XSS  güvenlik açıklarına bakacağız.

## Cross site scripting (XSS)

## XSS 1.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss1.PNG)

İlk olarak bizi "Hello Hacker" yazan bir sayfa karşılıyor.Burada URL kısmını kontrol ettiğimizde **name** parametresinin aldığı değeri ekrana bastığını görüyoruz.Buraya çağatay yazarak kontrol ediyoruz.
![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss2.PNG)
evet,cagatay yazısını ekrana bastı.cagatay yazısını ekrana bastığına göre buraya javascript payloadı denememiz durumunda çalışacak anlamına gelmekte.

    <script>alert("cagatay")</script>

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss3.PNG)

Herhangi bir filtre mekanizmasına takılmadan script çalıştı.

## XSS 2.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss4.PNG)

Burada birinci örnekteki gibi **name** parametresi aldığını görüyoruz. name parametresinin önüne bu sefer **cagatayceyhan** yazıyoruz. Birinci örnekteki gibi parametre URL kısmına yazdığımız örneği ekrana basıyor.

Bir önceki örnekte kullandığımız payloadı burada denediğimizde **<*script><*/script>**   
taglarının silindiğini görüyoruz, kalan değer olduğu gibi ekrana basılmış durumda.
Burada bir filtrelenme işlemi gerçekleştiğini anlıyoruz.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss5.PNG)

Burada bu filtreyi atlatmanın en etkili yollarından birisi <*scRIPT><*/scRIPT> yada <*SCRIPT><*/SCRIPT> gibi ifadeleri deneyerek  filtreyi atlatabiliriz.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss6.PNG)

Büyük harfleri filtrelemediği için payload çalıştı.

    <scRIPt>alert(cagatayceyhan)</scRIPt>

## XSS 3.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss7.PNG)

Buradada ilk iki örnekte olduğu gibi **name** parametresi cıktıyı ekrana basıyor ancak bir önceki örnekte kullandığımız büyük harfli payload burada işe yaramadığını görüyoruz.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss8.PNG)

Burada farklı bir işlem olan iç içe script kelimelerini yazarak payload işlemini gerçekleştiriyoruz.

    <sc<script>ript>alert("cagatayCEYHAN")</sc</script>ript>

## XSS 4.ÖRNEK

Bu örnekte diğer örneklerden farklı olarak script ifadesi tamamen engellenmiş durumda,script ifadesi içeren bir payload denendiğinde error veriyor, bu yüzden farklı bir payload denememiz gerekli.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss9.PNG)

burada farklı olarak 

    <svg onload=alert("Çağatay Ceyhan")>

payloadını deniyoruz ve başarılı oluyoruz.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss10.PNG)

## XSS 5.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss11.PNG)

**name** parametresi yine ekrana istediğimiz değerleri basıyor.Payload denediğimizde yine **error** cevabı ile karşılaşıyoruz.tagları ve işaretleri sildiğimde alert fonksiyonunun engellendiğini görüyorum.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss12.PNG)

Burada alert fonksiyonu yerine kullanabileceğimiz bir diğer fonksiyon **prompt** dur.Prompt komutunu kullandığımızda payloadın çalıştığını görüyoruz.

    <script>prompt("helloWorld")</script>


## XSS 6.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss13.PNG)

Bu uygulamada **name** parametresinin sonuna girilen değer ekrana basılmıyor.Kaynağı incelediğimizde değerin mevcut script taglarının içinde bir değişkene atandığını görüyoruz.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss14.PNG)

alert fonksiyonunu direk URL üzerinden tırnaklı ifadeler kullanarak oluşturduğumuz payload'ı çalıştırabiliriz.

    ";alert("cagatay");"

## XSS 7.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss15.PNG)

Buradaki yapı 6. örnekle tamamen aynı burada 6.örnekten farklı olarak sadece çift tırnak yerine tek tırnak kullanıyoruz.

    ';alert('cagatayceyhan');'    


## XSS 8.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss16.PNG)

Bu örnekte artık URL üzerinden bir değer giremiyoruz.Ancak kaynağı incelediğimizde /xss/example8.php bağlantısına post işlemi yaptığını görüyoruz.

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss17.PNG)

Bu durumda form yapısı altında script çalıştırmayı deneceğiz.İlk olarak dizini sonlandırıp parametreyi kapatıp payload'ı yazmamız gerekiyor.Gerekli işlemi yaptıktan sonra payload aktif oluyor.

    /"><script>alert("ÇagatayCeyhan")</script>

## XSS 9.ÖRNEK

![](https://raw.githubusercontent.com/cagatayceyhan/terminal_Img/main/xss18.PNG)

Bu örnekte XSS DOM zafiyeti bulunmaktadır.ancak buradaki zafiyet yalnızca eski tarayıcılarda çalışmakta, bende bulunan hiçbir tarayıcıda çalıştıramadım.Ancak zafiyet **#** işaretinden sonra yazılan payloadları çalıştıracaktır.

    <scipt>alert("ÇağatayCeyhan")</script>

